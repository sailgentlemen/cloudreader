(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/bookshelf/bookshelf"],{3502:function(t,e,o){"use strict";o.r(e);var n=o("f4f9"),r=o.n(n);for(var s in n)"default"!==s&&function(t){o.d(e,t,(function(){return n[t]}))}(s);e["default"]=r.a},9552:function(t,e,o){},c17f:function(t,e,o){"use strict";var n=o("9552"),r=o.n(n);r.a},c20d:function(t,e,o){"use strict";(function(t){o("ac90"),o("921b");n(o("66fd"));var e=n(o("f7b5"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},d5a2:function(t,e,o){"use strict";var n={ToTop:function(){return o.e("components/ToTop/ToTop").then(o.bind(null,"754c"))}},r=function(){var t=this,e=t.$createElement,o=(t._self._c,{position:"absolute",bottom:"15vh",right:"6vw"});t.$mp.data=Object.assign({},{$root:{a0:o}})},s=[];o.d(e,"b",(function(){return r})),o.d(e,"c",(function(){return s})),o.d(e,"a",(function(){return n}))},f4f9:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(o("4795"));function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e,o,n,r,s,i){try{var c=t[s](i),a=c.value}catch(u){return void o(u)}c.done?e(a):Promise.resolve(a).then(n,r)}function i(t){return function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function c(t){s(i,n,r,c,a,"next",t)}function a(t){s(i,n,r,c,a,"throw",t)}c(void 0)}))}}var c={computed:{showNoResul:function(){return!this.$store.state.qsList.length&&this.$store.state.typing},userInfo:function(){return this.$store.state.userInfo},count:function(){return this.booksList.filter((function(t){return t.selected})).length},tip:function(){return this.selectedAll?"取消全选":"全选"},isNoBooks:function(){return!!this.booksList.length}},data:function(){return{booksList:[],selectedAll:!1,edit:!1,showToTop:!1,scrollTop:0,old:{scrollTop:0},mockBooks:[]}},methods:{goReading:function(e){t.navigateTo({url:"/pages/read/read?_id="+e})},removeBooksFromBookcases:function(e){return i(n.default.mark((function o(){return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.showLoading({title:"加载中..."}),o.next=3,wx.cloud.callFunction({name:"removeFromBookcase",data:{books:e}});case 3:o.sent,t.hideLoading();case 5:case"end":return o.stop()}}),o)})))()},getBookcases:function(){var e=this;return i(n.default.mark((function o(){var r,s,i,c;return n.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return t.showLoading({title:"加载中..."}),o.next=3,wx.cloud.callFunction({name:"getBookcases"});case 3:if(r=o.sent,t.hideLoading(),r.result.data[0].bookrack.length){if(s=r.result.data[0].bookrack,3-s.length%3)for(i=3-s.length%3,c=0;c<i;++c)s.push({_id:c,bookName:"placeholder"});e.booksList=s.map((function(t){return e.$set(t,"selected",!1),t}))}case 6:case"end":return o.stop()}}),o)})))()},deleteHandle:function(){var t=this;return i(n.default.mark((function e(){var o,r,s;return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.count){e.next=2;break}return e.abrupt("return");case 2:return o=t.booksList.filter((function(t){return t.selected&&"placeholder"!==t.bookName})),e.next=5,t.removeBooksFromBookcases(o);case 5:if(t.selectedAll=!1,t.booksList=t.booksList.filter((function(t){return!t.selected})),3-t.booksList.length%3)for(r=3-t.booksList.length%3,s=0;s<r;++s)t.booksList.push({_id:s,bookName:"placeholder",selected:!1});t.booksList.every((function(t){return"placeholder"===t.bookName}))&&(t.edit=!1,t.booksList=[]);case 9:case"end":return e.stop()}}),e)})))()},selectedAllHandle:function(){this.booksList.length&&(this.selectedAll?(this.booksList=this.booksList.map((function(t){return"placeholder"!==t.bookName&&(t.selected=!1),t})),this.selectedAll=!1):(this.booksList=this.booksList.map((function(t){return"placeholder"!==t.bookName&&(t.selected=!0),t})),this.selectedAll=!0))},finishedHandle:function(){this.edit=!1,this.booksList.forEach((function(t){return t.selected=!1}))},editHandle:function(){this.booksList.length&&(this.edit=!0)},getBook:function(t){return i(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,wx.cloud.callFunction({name:"getBook",data:{_id:t}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()},tapHandle:function(t,e){var o=this;return i(n.default.mark((function r(){return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if("placeholder"!==e.bookName){n.next=4;break}return n.abrupt("return");case 4:if(o.edit){n.next=9;break}return o.goReading(e._id),n.abrupt("return");case 9:o.selectedAll=!1,o.booksList[t].selected=!o.booksList[t].selected,o.booksList.filter((function(t){return"placeholder"!==t.bookName})).every((function(t){return!0===t.selected}))&&(o.selectedAll=!0);case 12:case"end":return n.stop()}}),r)})))()},goHandle:function(){t.switchTab({url:"/pages/bookmall/bookmall"})},goTopHandle:function(){var t=this;this.scrollTop=0,this.scrollTop=this.old.scrollTop,this.$nextTick((function(){t.scrollTop=0}))},scrollHandle:function(t){this.old.scrollTop=t.detail.scrollTop,t.detail.scrollTop>666?this.showToTop=!0:this.showToTop=!1}},onShow:function(){this.userInfo&&this.getBookcases()},onHide:function(){this.edit&&(this.edit=!1)},onLoad:function(){var e=i(n.default.mark((function e(){return n.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.userInfo){e.next=3;break}return t.reLaunch({url:"/pages/login/login"}),e.abrupt("return");case 3:return t.showLoading({title:"加载中"}),this.$store.commit("typing",!1),this.$store.commit("qsList",[]),e.next=8,this.$store.dispatch("qsList");case 8:t.hideLoading();case 9:case"end":return e.stop()}}),e,this)})));function o(){return e.apply(this,arguments)}return o}()};e.default=c}).call(this,o("543d")["default"])},f7b5:function(t,e,o){"use strict";o.r(e);var n=o("d5a2"),r=o("3502");for(var s in r)"default"!==s&&function(t){o.d(e,t,(function(){return r[t]}))}(s);o("c17f");var i,c=o("f0c5"),a=Object(c["a"])(r["default"],n["b"],n["c"],!1,null,"5cdda34c",null,!1,n["a"],i);e["default"]=a.exports}},[["c20d","common/runtime","common/vendor"]]]);